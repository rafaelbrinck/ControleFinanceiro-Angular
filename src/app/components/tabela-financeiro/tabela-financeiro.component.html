<div class="container my-4 max-w-800 pb-5">
  
  <!-- Cabeçalho -->
  <div class="d-flex justify-content-between align-items-center mb-4 px-2">
    <div>
      <h4 class="fw-bold text-dark mb-0">Extrato</h4>
      <small class="text-muted">Suas movimentações</small>
    </div>
    <a class="btn btn-primary rounded-pill shadow-sm d-flex align-items-center gap-2" routerLink="/novo">
      <i class="bi bi-plus-lg"></i> <span class="d-none d-sm-inline">Nova Transação</span>
    </a>
  </div>

  <!-- Barra de Busca e Filtros -->
  <div class="card border-0 shadow-sm rounded-4 mb-4 bg-white overflow-hidden">
    <div class="card-body p-2 d-flex flex-column flex-sm-row gap-2">
      
      <!-- Select de Filtro -->
      <div class="filter-select-wrapper position-relative" style="min-width: 120px;">
        <select class="form-select border-0 bg-light fw-medium py-2 ps-3 h-100" [(ngModel)]="campoPesquisa">
          <option value="nome">Descrição</option>
          <option value="tipo">Tipo</option>
          <option value="cat">Categoria</option>
        </select>
      </div>

      <!-- Input de Busca -->
      <div class="search-box flex-grow-1 bg-light rounded-3 d-flex align-items-center px-3">
        <i class="bi bi-search text-muted"></i>
        <input 
          type="text" 
          class="form-control border-0 bg-transparent shadow-none" 
          [(ngModel)]="nomePesquisa" 
          placeholder="Buscar no extrato..."
        >
      </div>
    </div>
  </div>

  <!-- Estado Vazio -->
  <div *ngIf="(lista | buscador:nomePesquisa:[campoPesquisa]).length === 0" class="text-center py-5 fade-in">
    <div class="bg-light rounded-circle d-inline-flex p-4 mb-3 text-secondary">
      <i class="bi bi-receipt fs-1"></i>
    </div>
    <h5 class="fw-bold text-secondary">Nenhuma transação encontrada</h5>
    <p class="text-muted small">Adicione receitas ou despesas para ver aqui.</p>
  </div>

  <!-- Lista de Cards (Layout Extrato) -->
  <div class="d-flex flex-column gap-3">
    
    <div 
      class="card transaction-card border-0 shadow-sm" 
      *ngFor="let transacao of (lista | buscador:nomePesquisa:[campoPesquisa])"
    >
      <div class="card-body p-3 d-flex align-items-center justify-content-between">
        
        <!-- Esquerda: Ícone e Info -->
        <div class="d-flex align-items-center gap-3 overflow-hidden flex-grow-1">
          
          <!-- Ícone Dinâmico -->
          <div class="transaction-icon flex-shrink-0" [ngClass]="{
            'bg-success-subtle text-success': transacao.tipo === 'Entrada',
            'bg-danger-subtle text-danger': transacao.tipo === 'Saida'
          }">
            <i class="bi" [ngClass]="{
              'bi-arrow-down-left': transacao.tipo === 'Entrada',
              'bi-arrow-up-right': transacao.tipo === 'Saida'
            }"></i>
          </div>

          <div class="overflow-hidden">
            <h6 class="mb-0 fw-bold text-dark text-truncate">{{ transacao.nome }}</h6>
            <div class="d-flex align-items-center gap-2 mt-1">
              <small class="text-muted">{{ transacao.data | date: 'dd/MM/yyyy' }}</small>
              <span class="text-muted small">•</span>
              <span class="badge bg-light text-secondary border fw-normal">{{ transacao.cat }}</span>
            </div>
          </div>
        </div>

        <!-- Direita: Valor e Menu -->
        <div class="text-end ms-3">
          <span class="d-block fw-bold fs-6" [ngClass]="{
            'text-success': transacao.tipo === 'Entrada',
            'text-danger': transacao.tipo === 'Saida'
          }">
            {{ transacao.tipo === 'Entrada' ? '+' : '-' }} {{ transacao.valor | moeda }}
          </span>
          
          <!-- Botões de Ação (Dropdown ou diretos) -->
          <div class="mt-2 d-flex gap-2 justify-content-end opacity-0 action-buttons">
             <a routerLink="/edit/{{ transacao.id }}" class="btn btn-sm btn-link p-0 text-primary"><i class="bi bi-pencil-fill"></i></a>
             <button (click)="deletar(transacao.id)" class="btn btn-sm btn-link p-0 text-danger"><i class="bi bi-trash-fill"></i></button>
          </div>
          <!-- Mobile Actions (Sempre visíveis no mobile via CSS se preferir, ou apenas clicando no card) -->
          <div class="mt-1 d-block d-sm-none text-end">
             <a routerLink="/edit/{{ transacao.id }}" class="text-decoration-none text-primary me-3 small fw-bold">Editar</a>
             <button (click)="deletar(transacao.id)" class="btn btn-link p-0 text-danger text-decoration-none small fw-bold">Excluir</button>
          </div>

        </div>
      </div>
    </div>

  </div>
</div>